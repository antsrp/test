# Тестовое задание для backend-разработчика (Balance service)

Параметры запуска:

Swagger: http://localhost:5000/swagger/index.html

## Доступные запросы

Добавление суммы на баланс пользователя происходит с помощью запроса
### POST /api/v1/add-balance
Параметры передаются в body: 
{
  "balance": 200,
  "comment": "some description of comment",
  "time": "2020-03-21T12:00:00Z",
  "user_id": 1
}
user_id - уникальный идентификатор пользователя
balance - сумма, на которую необходимо увеличить баланс
comment - комментарий, сопровождающий операцию пополнения
time - время пополнения в формате RFC3339

Получение баланса пользователя:
### GET /api/v1/get-balance?user_id="id"
query параметр user_id - уникальный идентификатор пользователя

Метод резервирования средств:
### POST /api/v1/reserve
Параметры передаются в body: 
{
  "comment": "des",
  "cost": 100,
  "order_id": 10,
  "service_id": 3,
  "user_id": 4
}
user_id - уникальный идентификатор пользователя
cost - стоимость операции
comment - комментарий, сопровождающий операцию резервирования
order_id - уникальный идентификатор заказа
service_id - уникальный идентификатор услуги

Операция выполнима в том случае, если стоимость операции не превосходит суммы баланса пользователя и уже зарезервированных средств на другие операции этим пользователем

Метод признания средств:
### PUT /api/v1/get-revenue
Параметры передаются в body: 
{
  "time": "2020-03-21T12:00:00Z",
  "cost": 100,
  "order_id": 10,
  "service_id": 3,
  "user_id": 4
}

user_id - уникальный идентификатор пользователя
cost - стоимость операции
time - время признания в формате RFC3339
order_id - уникальный идентификатор заказа
service_id - уникальный идентификатор услуги

Сводный отчет по пользователям:
### GET /api/v1/summary?month="month"&year="year"
Query-параметры:
month - месяц для сбора отчета
year - год для сбора отчета

Ответ содержит в себе ссылку на сформированный CSV-файл.

Метод получения списка транзакций для пользователя:
### GET /api/v1/operations?user_id="id"&page="page"&sort="sort"&direction="direction"
Query-параметры:
user_id - уникальный идентификатор пользователя
page - номер страницы. Не является обязательным - если не указать данный параметр, в ответе будут присутствовать все операции. В обратном случае, ответ будет содержать лимитированное количество транзакций (данную настройку можно изменить в конфиг-файле db_config.yaml в каталоге configs).
sort - критерий сортировки:
    "sum": сортировка по сумме
    "date": сортировка по дате
direction - направление сортировки:
    "ASC": по возрастанию
    "DESC": по убыванию
Если опустить параметры сортировки, то операции будут приведены в хронологическом порядке.